# Lucia Sidecar — Environment template (Open Web UI alongside deployment)
#
# Copy to .env in this directory (infra/docker):
#   cp .env.lucia.example .env
# Then set HomeAssistant__AccessToken and optionally adjust URLs.
#
# Use with: docker compose -f docker-compose.yml -f docker-compose.lucia-sidecar.yml --env-file .env up -d
#
# Home Assistant runs on a different host (e.g. 192.168.1.198). Lucia runs on the
# same machine as your Open Web UI stack and reaches Ollama via host.docker.internal.

################################################################################
# REQUIRED — HOME ASSISTANT (remote)
################################################################################

# Home Assistant instance URL (Machine B)
# Use IP or hostname (e.g. home-assist.dunn.local if VIRTUAL_HOST/DNS)
HomeAssistant__BaseUrl=http://192.168.1.198:8123

# Long-lived access token (HA → Profile → Long-Lived Access Tokens)
HomeAssistant__AccessToken=PLACEHOLDER_REPLACE_WITH_ACTUAL_TOKEN

################################################################################
# OPTIONAL — Headless setup (skip wizard when all set)
################################################################################
# When DASHBOARD_API_KEY + HomeAssistant__* are set, Lucia auto-configures on startup.
# Use lk_ prefix for keys (e.g. lk_YourRandomBase64String). Min 16 chars.
# DASHBOARD_API_KEY=lk_...   # Log in to Lucia dashboard
# LUCIA_HA_API_KEY=lk_...    # Enter in HA integration (Settings → Lucia → API Key)

################################################################################
# REQUIRED — LLM (Ollama on same host as Open Web UI)
################################################################################

# Ollama shared with Open Web UI — from Lucia container use host.docker.internal
ConnectionStrings__chat-model=Endpoint=http://host.docker.internal:11434;AccessKey=ollama;Model=llama3.2;Provider=ollama

# Embedding model for light semantic search, location matching (e.g. "bathroom downstairs" → "Basement bathroom")
# Requires nomic-embed-text in Ollama: ollama pull nomic-embed-text (or use OLLAMA_MODELS in docker-compose)
ConnectionStrings__embeddings=Endpoint=http://host.docker.internal:11434;Model=nomic-embed-text;Provider=ollama

################################################################################
# OPTIONAL — Shared capability URLs (for MCP / custom agents / future use)
# From Lucia container use host.docker.internal to reach host-bound ports.
################################################################################

# Web search (SearXNG) — when set, General Agent gets web_search tool (aligned with Open Web UI)
# SEARXNG_URL=http://host.docker.internal:8081

# Image generation (ComfyUI)
# COMFYUI_URL=http://host.docker.internal:8188

# STT — Whisper ASR (HTTP)
# WHISPER_ASR_URL=http://host.docker.internal:8083

# TTS — Piper bridge (HTTP)
# PIPER_TTS_URL=http://host.docker.internal:8085

# Wyoming Whisper (STT) — TCP Wyoming protocol
# WYOMING_WHISPER_URI=tcp://host.docker.internal:10300

# Wyoming Piper (TTS) — host port 8084 or use PIPER_TTS_URL above for HTTP

# MCP tools (MetaMCP) — auto-seeded when set; full SSE endpoint required
# METAMCP_URL=http://host.docker.internal:12008/metamcp/openwebui-api/sse
# METAMCP_API_KEY=sk_mt_...  # MetaMCP API key (Dashboard → Keys)

################################################################################
# REMINDER — Agent Repository URL for Home Assistant integration
################################################################################
# In HA: Add Integration → Lucia → Agent Repository URL = http://<this-machine-ip>:7233
# Replace <this-machine-ip> with the LAN IP of the host running Lucia (Machine A).
