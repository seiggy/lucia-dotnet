---
config:
  theme: dark
---
%% System Context Diagram
%% Audience: Solution architects & integration teams | Purpose: Highlight core actors and boundaries
flowchart TB
  classDef actor fill:#1f77b4,color:#ffffff,stroke:#85c0f9,stroke-width:2px;
  classDef platform fill:#2ca02c,color:#0a0a0a,stroke:#98df8a,stroke-width:2px;
  classDef external fill:#ff7f0e,color:#0a0a0a,stroke:#ffbb78,stroke-width:2px;
  classDef service fill:#9467bd,color:#ffffff,stroke:#c5b0d5,stroke-width:2px;

  subgraph Home_Assistant["Home Assistant Deployment"]
    haPlugin["Lucia Conversation Plugin\n(custom component)"]:::service
    haAPIs["Home Assistant APIs\n(Conversation, REST, LLM)"]:::service
    haDevices["Automations & Smart Devices"]:::external
  end

  subgraph Lucia_Platform["Lucia Agent Platform (.NET Aspire)"]
    luciaAPI["Lucia API Service\n(lucia-dotnet)"]:::platform
    registry["Agent Registry & A2A Gateway"]:::platform
    orchestration["Semantic Kernel Orchestration\n(lucia.Agents)"]:::platform
  end

  user["Homeowner / Operator"]:::actor
  haCore["Home Assistant Core"]:::service
  llmProviders["LLM Providers\n(OpenAI, Gemini, Claude, Local)"]:::external

  user -->|"Voice/Text Request"| haPlugin
  haPlugin -->|"Conversation intents"| haAPIs
  haAPIs -->|"Agent registry lookup"| luciaAPI
  luciaAPI -->|"A2A coordination"| orchestration
  orchestration -->|"Action directives"| haAPIs
  haAPIs -->|"Device updates"| haDevices
  orchestration -.->|"Optional prompts"| llmProviders
  haPlugin -->|"Skill metadata"| registry
  haCore -->|"Executes automations"| haDevices
